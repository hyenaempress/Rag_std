Djangoë¥¼ ì‚¬ìš©í•´ì„œ RAG(Retrieval-Augmented Generation) ì±—ë´‡ì„ ë§Œë“  ì „ì²´ ê³¼ì •ì„ ë‹¨ê³„ë³„ë¡œ ì •ë¦¬í•œ ë¬¸ì„œì…ë‹ˆë‹¤.

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”

- **ëª©í‘œ**: ë¬¸ì„œ ì—…ë¡œë“œ í›„ ì§ˆë¬¸-ë‹µë³€ì´ ê°€ëŠ¥í•œ RAG ì‹œìŠ¤í…œ
- **ê¸°ìˆ  ìŠ¤íƒ**: Django, LangChain, í‚¤ì›Œë“œ ê¸°ë°˜ ê²€ìƒ‰
- **ì£¼ìš” ê¸°ëŠ¥**: í…ìŠ¤íŠ¸/íŒŒì¼ ì—…ë¡œë“œ, ì‹¤ì‹œê°„ ì±„íŒ…, ë¬¸ì„œ ê²€ìƒ‰

## ğŸ“ 1ë‹¨ê³„: í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì •

```bash
# í˜„ì¬ ìœ„ì¹˜ë¡œ ì´ë™
PS D:\work\Rag_std\django_rag> cd ..
PS D:\work\Rag_std> mkdir django_rag_chatbot
PS D:\work\Rag_std> cd django_rag_chatbot

# Django í”„ë¡œì íŠ¸ ìƒì„± (í˜„ì¬ í´ë”ì—)
PS D:\work\Rag_std\django_rag_chatbot> django-admin startproject mainapp .

# Django ì•± ìƒì„±
PS D:\work\Rag_std\django_rag_chatbot> python manage.py startapp chatbot

# í…œí”Œë¦¿ ë””ë ‰í† ë¦¬ ìƒì„±
PS D:\work\Rag_std\django_rag_chatbot> mkdir templates
PS D:\work\Rag_std\django_rag_chatbot> mkdir templates\chatbot
```

ì´ë ‡ê²Œ í•˜ë©´ ê¹”ë”í•œ êµ¬ì¡°ê°€ ë  ê±°ì˜ˆìš”:

```
django_rag_chatbot/
â”œâ”€â”€ manage.py
â”œâ”€â”€ mainapp/
â”‚   â”œâ”€â”€ settings.py
â”‚   â”œâ”€â”€ urls.py
â”‚   â””â”€â”€ ...
â”œâ”€â”€ chatbot/
â”‚   â”œâ”€â”€ views.py
â”‚   â”œâ”€â”€ models.py
â”‚   â””â”€â”€ ...
â””â”€â”€ templates/
    â””â”€â”€ chatbot/
```

ê·¸ë¦¬ê³  ì„œë²„ ì‹¤í–‰í•´ì„œ ì˜ ë˜ëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”:

bash

```bash
PS D:\work\Rag_std\django_rag_chatbot> python manage.py runserver
```

## 1ë‹¨ê³„: settings.py ì„¤ì •

`mainapp/settings.py`ë¥¼ ì—´ì–´ì„œ ìˆ˜ì •:

python

```python
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'chatbot',  # ì¶”ê°€
]

# í…œí”Œë¦¿ ê²½ë¡œ ì¶”ê°€
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [BASE_DIR / 'templates'],  # ì´ ë¶€ë¶„ ìˆ˜ì •
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]
```

## 2ë‹¨ê³„: URL ì—°ê²°

`mainapp/urls.py`:

python

```python
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('chatbot.urls')),  # ì¶”ê°€
]
```

## 3ë‹¨ê³„: chatbot ì•±ì˜ urls.py ìƒì„±

`chatbot/urls.py` íŒŒì¼ì„ ìƒˆë¡œ ë§Œë“¤ì–´ì„œ:

python

```python
from django.urls import path
from . import views

urlpatterns = [
    path('', views.chatbot_view, name='chatbot'),
]
```

## 4ë‹¨ê³„: ê°„ë‹¨í•œ ë·° ë§Œë“¤ê¸°

`chatbot/views.py`:

python

```python
from django.shortcuts import render

def chatbot_view(request):
    return render(request, 'chatbot/chatbot.html')
```

## 5ë‹¨ê³„: ê¸°ë³¸ í…œí”Œë¦¿ ë§Œë“¤ê¸°

`templates/chatbot/chatbot.html`:

html

```html
<!DOCTYPE html>
<html>
<head>
    <title>RAG ì±—ë´‡</title>
    <meta charset="utf-8">
</head>
<body>
    <h1>RAG ì±—ë´‡ í…ŒìŠ¤íŠ¸</h1>
    <p>ì„¤ì •ì´ ì œëŒ€ë¡œ ë˜ì—ˆìŠµë‹ˆë‹¤!</p>
</body>
</html>
```

ì´ì œ ì„œë²„ ì‹¤í–‰í•´ì„œ `http://127.0.0.1:8000/`ì—ì„œ í™•ì¸í•´ë³´ì„¸ìš”!

bash

```bash
python manage.py runserver
```

í˜ì´ì§€ê°€ ë‚˜ì˜¤ë©´ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆì–´ìš”.

## 6ë‹¨ê³„: ì±„íŒ… UI ë§Œë“¤ê¸°

`templates/chatbot/chatbot.html`ì„ ë‹¤ì‹œ ë§Œë“¤ì–´ìš”:

html

```html
<!DOCTYPE html>
<html>
<head>
    <title>RAG ì±—ë´‡</title>
    <meta charset="utf-8">
    <style>
        .chat-container { 
            max-width: 800px; 
            margin: 50px auto; 
            border: 1px solid #ddd; 
            border-radius: 10px;
            overflow: hidden;
        }
        .chat-header { 
            background: #007bff; 
            color: white; 
            padding: 15px; 
            text-align: center; 
        }
        .chat-box { 
            height: 400px; 
            overflow-y: auto; 
            padding: 20px; 
            background: #f9f9f9; 
        }
        .message { 
            margin-bottom: 15px; 
            padding: 10px; 
            border-radius: 10px; 
            max-width: 70%; 
        }
        .user-message { 
            background: #007bff; 
            color: white; 
            margin-left: auto; 
            text-align: right; 
        }
        .bot-message { 
            background: white; 
            border: 1px solid #ddd; 
        }
        .input-container { 
            padding: 20px; 
            background: white; 
            display: flex; 
            gap: 10px; 
        }
        #messageInput { 
            flex: 1; 
            padding: 10px; 
            border: 1px solid #ddd; 
            border-radius: 5px; 
        }
        #sendBtn { 
            padding: 10px 20px; 
            background: #007bff; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
        }
        #sendBtn:hover { 
            background: #0056b3; 
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <h2>RAG ì±—ë´‡</h2>
        </div>
        
        <div id="chatBox" class="chat-box">
            <div class="message bot-message">
                ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?
            </div>
        </div>
        
        <div class="input-container">
            <input type="text" id="messageInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="handleKeyPress(event)">
            <button id="sendBtn" onclick="sendMessage()">ì „ì†¡</button>
        </div>
    </div>

    <script>
        function addMessage(message, isUser) {
            const chatBox = document.getElementById('chatBox');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ' + (isUser ? 'user-message' : 'bot-message');
            messageDiv.textContent = message;
            chatBox.appendChild(messageDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            if (!message) return;

            // ì‚¬ìš©ì ë©”ì‹œì§€ í‘œì‹œ
            addMessage(message, true);
            input.value = '';

            // ì„ì‹œë¡œ echo ì‘ë‹µ (ë‚˜ì¤‘ì— API ì—°ê²°)
            setTimeout(() => {
                addMessage(`Echo: ${message}`, false);
            }, 500);
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }
    </script>
</body>
</html>
```

ì´ì œ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ì‹¤ì œ ì±„íŒ…ì²˜ëŸ¼ ë³´ì´ëŠ” ì¸í„°í˜ì´ìŠ¤

## 7ë‹¨ê³„: AJAX API ë§Œë“¤ê¸°

### `chatbot/views.py` ìˆ˜ì •:

python

```python
from django.shortcuts import render
from django.http import JsonResponse
from django.views.decorators.csrf import csrf_exempt
import json

def chatbot_view(request):
    return render(request, 'chatbot/chatbot.html')

@csrf_exempt  # ê°œë°œìš© - ë‚˜ì¤‘ì— CSRF í† í° ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ìŒ
def chat_api(request):
    if request.method == 'POST':
        try:
            data = json.loads(request.body)
            user_message = data.get('message', '')
            
            # ê°„ë‹¨í•œ í‚¤ì›Œë“œ ì‘ë‹µ ë¡œì§
            bot_response = get_bot_response(user_message)
            
            return JsonResponse({
                'response': bot_response,
                'status': 'success'
            })
        except Exception as e:
            return JsonResponse({
                'response': 'ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
                'status': 'error'
            })
    
    return JsonResponse({'status': 'error', 'message': 'POST ìš”ì²­ë§Œ í—ˆìš©ë©ë‹ˆë‹¤.'})

def get_bot_response(message):
    """ê°„ë‹¨í•œ í‚¤ì›Œë“œ ê¸°ë°˜ ì‘ë‹µ"""
    message = message.lower()
    
    if 'ì•ˆë…•' in message or 'hello' in message:
        return "ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?"
    elif 'ì´ë¦„' in message:
        return "ì €ëŠ” RAG ì±—ë´‡ì…ë‹ˆë‹¤!"
    elif 'ë‚ ì”¨' in message:
        return "ì£„ì†¡í•©ë‹ˆë‹¤. ì•„ì§ ë‚ ì”¨ ì •ë³´ëŠ” ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
    elif 'ì‹œê°„' in message:
        from datetime import datetime
        now = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
        return f"í˜„ì¬ ì‹œê°„ì€ {now}ì…ë‹ˆë‹¤."
    elif 'rag' in message:
        return "RAGëŠ” Retrieval-Augmented Generationì˜ ì¤„ì„ë§ë¡œ, ë¬¸ì„œ ê²€ìƒ‰ ê¸°ë°˜ ìƒì„± AIì…ë‹ˆë‹¤!"
    elif 'ë„ì›€' in message or 'help' in message:
        return "ì €ëŠ” ë¬¸ì„œ ê¸°ë°˜ ì§ˆë¬¸ì— ë‹µë³€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê¶ê¸ˆí•œ ê²ƒì„ ë¬¼ì–´ë³´ì„¸ìš”!"
    else:
        return f"'{message}'ì— ëŒ€í•´ ë” êµ¬ì²´ì ìœ¼ë¡œ ì•Œë ¤ì£¼ì‹œë©´ ë„ì›€ì„ ë“œë¦´ ìˆ˜ ìˆì–´ìš”!"
```

### `chatbot/urls.py` ìˆ˜ì •:

python

```python
from django.urls import path
from . import views

urlpatterns = [
    path('', views.chatbot_view, name='chatbot'),
    path('api/chat/', views.chat_api, name='chat_api'),  # API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€
]
```

### HTMLì˜ JavaScript ë¶€ë¶„ ìˆ˜ì •:

`templates/chatbot/chatbot.html`ì˜ `<script>` ë¶€ë¶„ì„ ì´ë ‡ê²Œ ë°”ê¿”ì£¼ì„¸ìš”:

javascript

```javascript
<script>
    function addMessage(message, isUser) {
        const chatBox = document.getElementById('chatBox');
        const messageDiv = document.createElement('div');
        messageDiv.className = 'message ' + (isUser ? 'user-message' : 'bot-message');
        messageDiv.textContent = message;
        chatBox.appendChild(messageDiv);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    async function sendMessage() {
        const input = document.getElementById('messageInput');
        const message = input.value.trim();
        if (!message) return;

        // ì‚¬ìš©ì ë©”ì‹œì§€ í‘œì‹œ
        addMessage(message, true);
        input.value = '';

        // ë¡œë”© ë©”ì‹œì§€
        addMessage('ìƒê° ì¤‘...', false);

        try {
            // Django API í˜¸ì¶œ
            const response = await fetch('/api/chat/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({message: message})
            });
            
            const data = await response.json();
            
            // ë¡œë”© ë©”ì‹œì§€ ì œê±°
            const chatBox = document.getElementById('chatBox');
            chatBox.removeChild(chatBox.lastChild);
            
            // ì‹¤ì œ ì‘ë‹µ í‘œì‹œ
            addMessage(data.response, false);
            
        } catch (error) {
            console.error('Error:', error);
            // ë¡œë”© ë©”ì‹œì§€ ì œê±°
            const chatBox = document.getElementById('chatBox');
            chatBox.removeChild(chatBox.lastChild);
            addMessage('ì£„ì†¡í•©ë‹ˆë‹¤. ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', false);
        }
    }

    function handleKeyPress(event) {
        if (event.key === 'Enter') {
            sendMessage();
        }
    }
</script>
```

ì´ì œ ì„œë²„ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ê³  í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”:

bash

```bash
python manage.py runserver
```

- "ì•ˆë…•í•˜ì„¸ìš”" ì…ë ¥í•´ë³´ê¸°
- "ì‹œê°„" ì…ë ¥í•´ë³´ê¸°
- "RAG" ì…ë ¥í•´ë³´ê¸°

ì‹¤ì œë¡œ Django ì„œë²„ì™€ í†µì‹ í•˜ë©´ì„œ í‚¤ì›Œë“œ ê¸°ë°˜ìœ¼ë¡œ ì‘ë‹µ
## 8ë‹¨ê³„: RAG ê¸°ëŠ¥ ì¶”ê°€

### 1. ë¨¼ì € í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

bash

```bash
pip install chromadb langchain sentence-transformers pypdf2 python-docx
```

### 2. RAG ì—”ì§„ ë§Œë“¤ê¸°

`chatbot/rag_engine.py` íŒŒì¼ì„ ìƒˆë¡œ ë§Œë“¤ì–´ìš”:

python

```python
import os
import chromadb
from langchain.vectorstores import Chroma
from langchain.embeddings import HuggingFaceEmbeddings
from langchain.document_loaders import PyPDFLoader, TextLoader
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain.docstore.document import Document
import docx

class RAGEngine:
    def __init__(self):
        self.embeddings = HuggingFaceEmbeddings(
            model_name="sentence-transformers/all-MiniLM-L6-v2"
        )
        self.vectorstore = None
        self.vectorstore_path = "./vectorstore"
        self.load_existing_vectorstore()
    
    def load_existing_vectorstore(self):
        """ê¸°ì¡´ ë²¡í„°ìŠ¤í† ì–´ê°€ ìˆìœ¼ë©´ ë¡œë“œ"""
        if os.path.exists(self.vectorstore_path):
            try:
                self.vectorstore = Chroma(
                    persist_directory=self.vectorstore_path,
                    embedding_function=self.embeddings
                )
                print("ê¸°ì¡´ ë²¡í„°ìŠ¤í† ì–´ë¥¼ ë¡œë“œí–ˆìŠµë‹ˆë‹¤.")
            except:
                print("ë²¡í„°ìŠ¤í† ì–´ ë¡œë“œ ì‹¤íŒ¨. ìƒˆë¡œ ìƒì„±í•©ë‹ˆë‹¤.")
                self.vectorstore = None
    
    def add_text_document(self, text, title="ë¬¸ì„œ"):
        """í…ìŠ¤íŠ¸ë¥¼ ì§ì ‘ ë²¡í„°ìŠ¤í† ì–´ì— ì¶”ê°€"""
        # í…ìŠ¤íŠ¸ë¥¼ ì²­í¬ë¡œ ë‚˜ëˆ„ê¸°
        text_splitter = RecursiveCharacterTextSplitter(
            chunk_size=1000,
            chunk_overlap=200,
            separators=["\n\n", "\n", ". ", " "]
        )
        
        # Document ê°ì²´ ìƒì„±
        doc = Document(page_content=text, metadata={"source": title})
        chunks = text_splitter.split_documents([doc])
        
        # ë²¡í„°ìŠ¤í† ì–´ì— ì¶”ê°€
        if self.vectorstore is None:
            self.vectorstore = Chroma.from_documents(
                chunks,
                embedding=self.embeddings,
                persist_directory=self.vectorstore_path
            )
        else:
            self.vectorstore.add_documents(chunks)
        
        self.vectorstore.persist()
        return len(chunks)
    
    def add_file_document(self, file_path):
        """íŒŒì¼ì„ ë²¡í„°ìŠ¤í† ì–´ì— ì¶”ê°€"""
        try:
            # íŒŒì¼ í™•ì¥ìì— ë”°ë¼ ë¡œë” ì„ íƒ
            if file_path.endswith('.pdf'):
                loader = PyPDFLoader(file_path)
                documents = loader.load()
            elif file_path.endswith('.txt'):
                loader = TextLoader(file_path, encoding='utf-8')
                documents = loader.load()
            elif file_path.endswith('.docx'):
                # docx íŒŒì¼ ì²˜ë¦¬
                doc = docx.Document(file_path)
                text = '\n'.join([paragraph.text for paragraph in doc.paragraphs])
                documents = [Document(page_content=text, metadata={"source": file_path})]
            else:
                return False, "ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤."
            
            # í…ìŠ¤íŠ¸ ë¶„í• 
            text_splitter = RecursiveCharacterTextSplitter(
                chunk_size=1000,
                chunk_overlap=200
            )
            chunks = text_splitter.split_documents(documents)
            
            # ë²¡í„°ìŠ¤í† ì–´ì— ì¶”ê°€
            if self.vectorstore is None:
                self.vectorstore = Chroma.from_documents(
                    chunks,
                    embedding=self.embeddings,
                    persist_directory=self.vectorstore_path
                )
            else:
                self.vectorstore.add_documents(chunks)
            
            self.vectorstore.persist()
            return True, f"{len(chunks)}ê°œ ì²­í¬ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."
            
        except Exception as e:
            return False, f"íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜: {str(e)}"
    
    def search_documents(self, query, k=3):
        """ë¬¸ì„œì—ì„œ ê´€ë ¨ ë‚´ìš© ê²€ìƒ‰"""
        if self.vectorstore is None:
            return []
        
        try:
            docs = self.vectorstore.similarity_search(query, k=k)
            return docs
        except:
            return []
    
    def get_rag_response(self, query):
        """RAG ê¸°ë°˜ ì‘ë‹µ ìƒì„±"""
        # ê´€ë ¨ ë¬¸ì„œ ê²€ìƒ‰
        relevant_docs = self.search_documents(query, k=3)
        
        if not relevant_docs:
            return "ì£„ì†¡í•©ë‹ˆë‹¤. ê´€ë ¨ëœ ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”."
        
        # ê²€ìƒ‰ëœ ë¬¸ì„œë“¤ì„ ì»¨í…ìŠ¤íŠ¸ë¡œ ì¡°í•©
        context = "\n\n".join([doc.page_content for doc in relevant_docs])
        
        # ê°„ë‹¨í•œ ì‘ë‹µ ìƒì„± (ì‹¤ì œë¡œëŠ” LLM APIë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ìŒ)
        response = f"ê²€ìƒ‰ëœ ê´€ë ¨ ë‚´ìš©:\n\n{context[:800]}..."  # 800ìë¡œ ì œí•œ
        
        return response
    
    def get_document_count(self):
        """ì €ì¥ëœ ë¬¸ì„œ ê°œìˆ˜ í™•ì¸"""
        if self.vectorstore is None:
            return 0
        try:
            collection = self.vectorstore._collection
            return collection.count()
        except:
            return 0

# ì „ì—­ RAG ì—”ì§„ ì¸ìŠ¤í„´ìŠ¤
rag_engine = RAGEngine()
```

### 3. ëª¨ë¸ ì¶”ê°€

`chatbot/models.py`:

python

```python
from django.db import models

class Document(models.Model):
    title = models.CharField(max_length=200)
    file = models.FileField(upload_to='documents/', null=True, blank=True)
    text_content = models.TextField(null=True, blank=True)  # ì§ì ‘ ì…ë ¥í•œ í…ìŠ¤íŠ¸
    uploaded_at = models.DateTimeField(auto_now_add=True)
    processed = models.BooleanField(default=False)
    chunk_count = models.IntegerField(default=0)
    
    def __str__(self):
        return self.title
```

### 4. ë·° ì—…ë°ì´íŠ¸

`chatbot/views.py`:

python

```python
from django.shortcuts import render
from django.http import JsonResponse
from django.views.decorators.csrf import csrf_exempt
from django.core.files.storage import default_storage
import json
import os
from .rag_engine import rag_engine
from .models import Document

def chatbot_view(request):
    # ì €ì¥ëœ ë¬¸ì„œ ê°œìˆ˜ ì •ë³´
    doc_count = rag_engine.get_document_count()
    context = {
        'document_count': doc_count
    }
    return render(request, 'chatbot/chatbot.html', context)

@csrf_exempt
def chat_api(request):
    if request.method == 'POST':
        try:
            data = json.loads(request.body)
            user_message = data.get('message', '')
            
            # RAG ì‘ë‹µ ì‹œë„
            if rag_engine.get_document_count() > 0:
                bot_response = rag_engine.get_rag_response(user_message)
            else:
                bot_response = get_simple_response(user_message)
            
            return JsonResponse({
                'response': bot_response,
                'status': 'success'
            })
        except Exception as e:
            return JsonResponse({
                'response': f'ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}',
                'status': 'error'
            })
    
    return JsonResponse({'status': 'error', 'message': 'POST ìš”ì²­ë§Œ í—ˆìš©ë©ë‹ˆë‹¤.'})

@csrf_exempt
def upload_text_api(request):
    """í…ìŠ¤íŠ¸ ì§ì ‘ ì—…ë¡œë“œ"""
    if request.method == 'POST':
        try:
            data = json.loads(request.body)
            text = data.get('text', '')
            title = data.get('title', 'ì§ì ‘ ì…ë ¥ ë¬¸ì„œ')
            
            if not text.strip():
                return JsonResponse({'status': 'error', 'message': 'í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'})
            
            # ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥
            doc = Document.objects.create(
                title=title,
                text_content=text,
                processed=False
            )
            
            # RAG ì—”ì§„ì— ì¶”ê°€
            chunk_count = rag_engine.add_text_document(text, title)
            
            # ì²˜ë¦¬ ì™„ë£Œ í‘œì‹œ
            doc.processed = True
            doc.chunk_count = chunk_count
            doc.save()
            
            return JsonResponse({
                'status': 'success', 
                'message': f'í…ìŠ¤íŠ¸ê°€ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. ({chunk_count}ê°œ ì²­í¬ ìƒì„±)',
                'document_count': rag_engine.get_document_count()
            })
            
        except Exception as e:
            return JsonResponse({'status': 'error', 'message': str(e)})

@csrf_exempt
def upload_file_api(request):
    """íŒŒì¼ ì—…ë¡œë“œ"""
    if request.method == 'POST' and request.FILES.get('file'):
        try:
            file = request.FILES['file']
            
            # íŒŒì¼ ì €ì¥
            file_path = default_storage.save(f'documents/{file.name}', file)
            full_path = default_storage.path(file_path)
            
            # ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥
            doc = Document.objects.create(
                title=file.name,
                file=file_path,
                processed=False
            )
            
            # RAG ì—”ì§„ì— ì¶”ê°€
            success, message = rag_engine.add_file_document(full_path)
            
            if success:
                doc.processed = True
                doc.save()
                return JsonResponse({
                    'status': 'success', 
                    'message': f'íŒŒì¼ì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. {message}',
                    'document_count': rag_engine.get_document_count()
                })
            else:
                doc.delete()  # ì‹¤íŒ¨ì‹œ DBì—ì„œ ì œê±°
                return JsonResponse({'status': 'error', 'message': message})
                
        except Exception as e:
            return JsonResponse({'status': 'error', 'message': str(e)})

def get_simple_response(message):
    """ë¬¸ì„œê°€ ì—†ì„ ë•Œì˜ ê°„ë‹¨í•œ ì‘ë‹µ"""
    message = message.lower()
    
    if 'ì•ˆë…•' in message:
        return "ì•ˆë…•í•˜ì„¸ìš”! ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•˜ë©´ ë” ì •í™•í•œ ë‹µë³€ì„ ë“œë¦´ ìˆ˜ ìˆì–´ìš”."
    elif 'ë¬¸ì„œ' in message or 'ì—…ë¡œë“œ' in message:
        return "ì•„ë˜ ì—…ë¡œë“œ ì„¹ì…˜ì—ì„œ í…ìŠ¤íŠ¸ë‚˜ íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”!"
    else:
        return "ì•„ì§ ì—…ë¡œë“œëœ ë¬¸ì„œê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•œ í›„ ì§ˆë¬¸í•´ì£¼ì„¸ìš”."
```

### 5. URL ì—…ë°ì´íŠ¸

`chatbot/urls.py`:

python

```python
from django.urls import path
from . import views

urlpatterns = [
    path('', views.chatbot_view, name='chatbot'),
    path('api/chat/', views.chat_api, name='chat_api'),
    path('api/upload-text/', views.upload_text_api, name='upload_text'),
    path('api/upload-file/', views.upload_file_api, name='upload_file'),
]
```

### 6. ì„¤ì •ì— ë¯¸ë””ì–´ íŒŒì¼ ê²½ë¡œ ì¶”ê°€

`mainapp/settings.py`:

python

```python
import os

# ê¸°ì¡´ ì„¤ì •ë“¤...

# ë¯¸ë””ì–´ íŒŒì¼ ì„¤ì • ì¶”ê°€
MEDIA_URL = '/media/'
MEDIA_ROOT = os.path.join(BASE_DIR, 'media')
```

`mainapp/urls.py`:

python

```python
from django.contrib import admin
from django.urls import path, include
from django.conf import settings
from django.conf.urls.static import static

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('chatbot.urls')),
] + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
```

### 7. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜

bash

```bash
python manage.py makemigrations
python manage.py migrate
```

ì´ì œ ê¸°ë³¸ RAG êµ¬ì¡°ê°€ ë§Œë“¤ì–´ì¡Œì–´ìš”!


ë””ë²„ê¹… í›„ ìˆ˜ì • 

```
import os

from langchain_community.vectorstores import Chroma

from langchain_community.document_loaders import PyPDFLoader, TextLoader

from langchain_text_splitters import RecursiveCharacterTextSplitter

from langchain_core.documents import Document

import docx

  

class SimpleEmbeddings:

Â  Â  """ê°„ë‹¨í•œ TF-IDF ê¸°ë°˜ ì„ë² ë”© (PyTorch ì—†ì´)"""

Â  Â  def __init__(self):

Â  Â  Â  Â  from sklearn.feature_extraction.text import TfidfVectorizer

Â  Â  Â  Â  self.vectorizer = TfidfVectorizer(max_features=1000)

Â  Â  Â  Â  self.fitted = False

Â  Â  def embed_documents(self, texts):

Â  Â  Â  Â  if not self.fitted:

Â  Â  Â  Â  Â  Â  self.vectorizer.fit(texts)

Â  Â  Â  Â  Â  Â  self.fitted = True

Â  Â  Â  Â  return self.vectorizer.transform(texts).toarray().tolist()

Â  Â  def embed_query(self, text):

Â  Â  Â  Â  if not self.fitted:

Â  Â  Â  Â  Â  Â  return [0] * 1000

Â  Â  Â  Â  return self.vectorizer.transform([text]).toarray()[0].tolist()

  

class RAGEngine:

Â  Â  def __init__(self):

Â  Â  Â  Â  # ì¼ë‹¨ ê°„ë‹¨í•œ ì„ë² ë”© ì‚¬ìš©

Â  Â  Â  Â  try:

Â  Â  Â  Â  Â  Â  from langchain_community.embeddings import HuggingFaceEmbeddings

Â  Â  Â  Â  Â  Â  self.embeddings = HuggingFaceEmbeddings(

Â  Â  Â  Â  Â  Â  Â  Â  model_name="sentence-transformers/all-MiniLM-L6-v2"

Â  Â  Â  Â  Â  Â  )

Â  Â  Â  Â  Â  Â  print("HuggingFace ì„ë² ë”©ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.")

Â  Â  Â  Â  except Exception as e:

Â  Â  Â  Â  Â  Â  print(f"HuggingFace ì„ë² ë”© ë¡œë“œ ì‹¤íŒ¨: {e}")

Â  Â  Â  Â  Â  Â  print("ê°„ë‹¨í•œ TF-IDF ì„ë² ë”©ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.")

Â  Â  Â  Â  Â  Â  self.embeddings = SimpleEmbeddings()

Â  Â  Â  Â  self.vectorstore = None

Â  Â  Â  Â  self.vectorstore_path = "./vectorstore"

Â  Â  Â  Â  self.documents = [] Â # ë¬¸ì„œ ì €ì¥ìš©

Â  Â  Â  Â  # ì¼ë‹¨ ë²¡í„°ìŠ¤í† ì–´ ë¡œë”©ì€ ìŠ¤í‚µ

Â  Â  def add_text_document(self, text, title="ë¬¸ì„œ"):

Â  Â  Â  Â  """í…ìŠ¤íŠ¸ë¥¼ ì €ì¥ (ì¼ë‹¨ ê°„ë‹¨í•˜ê²Œ)"""

Â  Â  Â  Â  # í…ìŠ¤íŠ¸ë¥¼ ì²­í¬ë¡œ ë‚˜ëˆ„ê¸°

Â  Â  Â  Â  text_splitter = RecursiveCharacterTextSplitter(

Â  Â  Â  Â  Â  Â  chunk_size=1000,

Â  Â  Â  Â  Â  Â  chunk_overlap=200,

Â  Â  Â  Â  Â  Â  separators=["\n\n", "\n", ". ", " "]

Â  Â  Â  Â  )

Â  Â  Â  Â  doc = Document(page_content=text, metadata={"source": title})

Â  Â  Â  Â  chunks = text_splitter.split_documents([doc])

Â  Â  Â  Â  # ì¼ë‹¨ ë©”ëª¨ë¦¬ì—ë§Œ ì €ì¥

Â  Â  Â  Â  self.documents.extend(chunks)

Â  Â  Â  Â  return len(chunks)

Â  Â  def add_file_document(self, file_path):

Â  Â  Â  Â  """íŒŒì¼ì„ ë¬¸ì„œë¡œ ì¶”ê°€"""

Â  Â  Â  Â  try:

Â  Â  Â  Â  Â  Â  if file_path.endswith('.pdf'):

Â  Â  Â  Â  Â  Â  Â  Â  loader = PyPDFLoader(file_path)

Â  Â  Â  Â  Â  Â  Â  Â  documents = loader.load()

Â  Â  Â  Â  Â  Â  elif file_path.endswith('.txt'):

Â  Â  Â  Â  Â  Â  Â  Â  loader = TextLoader(file_path, encoding='utf-8')

Â  Â  Â  Â  Â  Â  Â  Â  documents = loader.load()

Â  Â  Â  Â  Â  Â  elif file_path.endswith('.docx'):

Â  Â  Â  Â  Â  Â  Â  Â  doc = docx.Document(file_path)

Â  Â  Â  Â  Â  Â  Â  Â  text = '\n'.join([paragraph.text for paragraph in doc.paragraphs])

Â  Â  Â  Â  Â  Â  Â  Â  documents = [Document(page_content=text, metadata={"source": file_path})]

Â  Â  Â  Â  Â  Â  else:

Â  Â  Â  Â  Â  Â  Â  Â  return False, "ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤."

Â  Â  Â  Â  Â  Â  text_splitter = RecursiveCharacterTextSplitter(

Â  Â  Â  Â  Â  Â  Â  Â  chunk_size=1000,

Â  Â  Â  Â  Â  Â  Â  Â  chunk_overlap=200

Â  Â  Â  Â  Â  Â  )

Â  Â  Â  Â  Â  Â  chunks = text_splitter.split_documents(documents)

Â  Â  Â  Â  Â  Â  # ë©”ëª¨ë¦¬ì— ì €ì¥

Â  Â  Â  Â  Â  Â  self.documents.extend(chunks)

Â  Â  Â  Â  Â  Â  return True, f"{len(chunks)}ê°œ ì²­í¬ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."

Â  Â  Â  Â  except Exception as e:

Â  Â  Â  Â  Â  Â  return False, f"íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜: {str(e)}"

Â  Â  def search_documents(self, query, k=3):

Â  Â  Â  Â  """ê°„ë‹¨í•œ í‚¤ì›Œë“œ ê¸°ë°˜ ê²€ìƒ‰"""

Â  Â  Â  Â  if not self.documents:

Â  Â  Â  Â  Â  Â  return []

Â  Â  Â  Â  query = query.lower()

Â  Â  Â  Â  scored_docs = []

Â  Â  Â  Â  for doc in self.documents:

Â  Â  Â  Â  Â  Â  content = doc.page_content.lower()

Â  Â  Â  Â  Â  Â  score = 0

Â  Â  Â  Â  Â  Â  # ê°„ë‹¨í•œ í‚¤ì›Œë“œ ë§¤ì¹­

Â  Â  Â  Â  Â  Â  for word in query.split():

Â  Â  Â  Â  Â  Â  Â  Â  if word in content:

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  score += content.count(word)

Â  Â  Â  Â  Â  Â  if score > 0:

Â  Â  Â  Â  Â  Â  Â  Â  scored_docs.append((doc, score))

Â  Â  Â  Â  # ì ìˆ˜ìˆœ ì •ë ¬

Â  Â  Â  Â  scored_docs.sort(key=lambda x: x[1], reverse=True)

Â  Â  Â  Â  return [doc for doc, score in scored_docs[:k]]

Â  Â  def get_rag_response(self, query):

Â  Â  Â  Â  """RAG ê¸°ë°˜ ì‘ë‹µ ìƒì„±"""

Â  Â  Â  Â  relevant_docs = self.search_documents(query, k=3)

Â  Â  Â  Â  if not relevant_docs:

Â  Â  Â  Â  Â  Â  return "ì£„ì†¡í•©ë‹ˆë‹¤. ê´€ë ¨ëœ ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”."

Â  Â  Â  Â  context = "\n\n".join([doc.page_content for doc in relevant_docs])

Â  Â  Â  Â  response = f"ê²€ìƒ‰ëœ ê´€ë ¨ ë‚´ìš©:\n\n{context[:800]}..."

Â  Â  Â  Â  return response

Â  Â  def get_document_count(self):

Â  Â  Â  Â  """ì €ì¥ëœ ë¬¸ì„œ ì²­í¬ ê°œìˆ˜"""

Â  Â  Â  Â  return len(self.documents)

```
  
## 9ë‹¨ê³„: HTML ì—…ë°ì´íŠ¸ - ë¬¸ì„œ ì—…ë¡œë“œ ê¸°ëŠ¥ ì¶”ê°€

`templates/chatbot/chatbot.html`ì„ ì™„ì „íˆ ìƒˆë¡œ ë§Œë“¤ì–´ìš”:

html

```html
<!DOCTYPE html>
<html>
<head>
    <title>RAG ì±—ë´‡</title>
    <meta charset="utf-8">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            background: #f5f5f5; 
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .main-content {
            display: flex;
            gap: 20px;
        }
        .upload-section {
            flex: 1;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            height: fit-content;
        }
        .chat-section {
            flex: 2;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .upload-header {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
        .upload-tabs {
            display: flex;
            margin-bottom: 20px;
        }
        .tab-btn {
            flex: 1;
            padding: 10px;
            background: #f0f0f0;
            border: none;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
        }
        .tab-btn.active {
            background: #667eea;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
        }
        .form-group textarea {
            height: 120px;
            resize: vertical;
        }
        .upload-btn {
            background: #28a745;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
        }
        .upload-btn:hover {
            background: #218838;
        }
        .status-info {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        .chat-header {
            background: #667eea;
            color: white;
            padding: 15px 20px;
            text-align: center;
        }
        .chat-box {
            height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: #f9f9f9;
        }
        .message {
            margin-bottom: 15px;
            padding: 12px;
            border-radius: 10px;
            max-width: 80%;
            word-wrap: break-word;
        }
        .user-message {
            background: #667eea;
            color: white;
            margin-left: auto;
            text-align: right;
        }
        .bot-message {
            background: white;
            border: 1px solid #ddd;
            white-space: pre-line;
        }
        .input-container {
            padding: 20px;
            background: white;
            display: flex;
            gap: 10px;
            border-top: 1px solid #eee;
        }
        #messageInput {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 25px;
            outline: none;
        }
        #sendBtn {
            padding: 12px 25px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
        }
        #sendBtn:hover {
            background: #5a67d8;
        }
        .loading {
            opacity: 0.7;
        }
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
        }
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– RAG ì±—ë´‡</h1>
            <p>ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•˜ê³  ì§ˆë¬¸í•´ë³´ì„¸ìš”!</p>
        </div>

        <div class="main-content">
            <!-- ì—…ë¡œë“œ ì„¹ì…˜ -->
            <div class="upload-section">
                <div class="upload-header">ğŸ“ ë¬¸ì„œ ì—…ë¡œë“œ</div>
                
                <div class="upload-tabs">
                    <button class="tab-btn active" onclick="showTab('text-tab')">í…ìŠ¤íŠ¸ ì…ë ¥</button>
                    <button class="tab-btn" onclick="showTab('file-tab')">íŒŒì¼ ì—…ë¡œë“œ</button>
                </div>

                <!-- í…ìŠ¤íŠ¸ ì…ë ¥ íƒ­ -->
                <div id="text-tab" class="tab-content active">
                    <div class="form-group">
                        <label>ë¬¸ì„œ ì œëª©:</label>
                        <input type="text" id="textTitle" placeholder="ë¬¸ì„œ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label>ë‚´ìš©:</label>
                        <textarea id="textContent" placeholder="ë¬¸ì„œ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                    </div>
                    <button class="upload-btn" onclick="uploadText()">í…ìŠ¤íŠ¸ ì—…ë¡œë“œ</button>
                </div>

                <!-- íŒŒì¼ ì—…ë¡œë“œ íƒ­ -->
                <div id="file-tab" class="tab-content">
                    <div class="form-group">
                        <label>íŒŒì¼ ì„ íƒ:</label>
                        <input type="file" id="fileInput" accept=".txt,.pdf,.docx">
                    </div>
                    <button class="upload-btn" onclick="uploadFile()">íŒŒì¼ ì—…ë¡œë“œ</button>
                </div>

                <!-- ìƒíƒœ ì •ë³´ -->
                <div class="status-info">
                    <strong>ğŸ“Š í˜„ì¬ ìƒíƒœ:</strong><br>
                    ì €ì¥ëœ ë¬¸ì„œ: <span id="docCount">{{ document_count }}</span>ê°œ<br>
                    <div id="uploadMessage"></div>
                </div>
            </div>

            <!-- ì±„íŒ… ì„¹ì…˜ -->
            <div class="chat-section">
                <div class="chat-header">
                    <h3>ğŸ’¬ ì±„íŒ…</h3>
                </div>
                
                <div id="chatBox" class="chat-box">
                    <div class="message bot-message">
                        ì•ˆë…•í•˜ì„¸ìš”! ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•œ í›„ ì§ˆë¬¸í•´ì£¼ì„¸ìš”. ğŸ“š
                    </div>
                </div>
                
                <div class="input-container">
                    <input type="text" id="messageInput" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="handleKeyPress(event)">
                    <button id="sendBtn" onclick="sendMessage()">ì „ì†¡</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // íƒ­ ì „í™˜
        function showTab(tabId) {
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        // ë©”ì‹œì§€ ì¶”ê°€
        function addMessage(message, isUser) {
            const chatBox = document.getElementById('chatBox');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ' + (isUser ? 'user-message' : 'bot-message');
            messageDiv.textContent = message;
            chatBox.appendChild(messageDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        // ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡
        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            if (!message) return;

            // ì‚¬ìš©ì ë©”ì‹œì§€ í‘œì‹œ
            addMessage(message, true);
            input.value = '';

            // ì „ì†¡ ë²„íŠ¼ ë¹„í™œì„±í™”
            const sendBtn = document.getElementById('sendBtn');
            sendBtn.disabled = true;
            sendBtn.textContent = 'ì „ì†¡ì¤‘...';

            try {
                const response = await fetch('/api/chat/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({message: message})
                });
                
                const data = await response.json();
                addMessage(data.response, false);
                
            } catch (error) {
                console.error('Error:', error);
                addMessage('ì£„ì†¡í•©ë‹ˆë‹¤. ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', false);
            } finally {
                // ì „ì†¡ ë²„íŠ¼ ë³µì›
                sendBtn.disabled = false;
                sendBtn.textContent = 'ì „ì†¡';
            }
        }

        // í…ìŠ¤íŠ¸ ì—…ë¡œë“œ
        async function uploadText() {
            const title = document.getElementById('textTitle').value.trim();
            const content = document.getElementById('textContent').value.trim();
            
            if (!content) {
                showMessage('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }

            const uploadBtn = event.target;
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'ì—…ë¡œë“œ ì¤‘...';

            try {
                const response = await fetch('/api/upload-text/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        title: title || 'ì§ì ‘ ì…ë ¥ ë¬¸ì„œ',
                        text: content
                    })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    showMessage(data.message, 'success');
                    document.getElementById('textTitle').value = '';
                    document.getElementById('textContent').value = '';
                    document.getElementById('docCount').textContent = data.document_count;
                } else {
                    showMessage(data.message, 'error');
                }
                
            } catch (error) {
                showMessage('ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'í…ìŠ¤íŠ¸ ì—…ë¡œë“œ';
            }
        }

        // íŒŒì¼ ì—…ë¡œë“œ
        async function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            
            if (!file) {
                showMessage('íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            const uploadBtn = event.target;
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'ì—…ë¡œë“œ ì¤‘...';

            try {
                const response = await fetch('/api/upload-file/', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    showMessage(data.message, 'success');
                    fileInput.value = '';
                    document.getElementById('docCount').textContent = data.document_count;
                } else {
                    showMessage(data.message, 'error');
                }
                
            } catch (error) {
                showMessage('ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'íŒŒì¼ ì—…ë¡œë“œ';
            }
        }

        // ë©”ì‹œì§€ í‘œì‹œ
        function showMessage(message, type) {
            const messageDiv = document.getElementById('uploadMessage');
            messageDiv.className = type === 'success' ? 'success-message' : 'error-message';
            messageDiv.textContent = message;
            
            setTimeout(() => {
                messageDiv.textContent = '';
                messageDiv.className = '';
            }, 5000);
        }

        // Enter í‚¤ ì²˜ë¦¬
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }
    </script>
</body>
</html>
```

ì´ì œ ì„œë²„ë¥¼ ì‹¤í–‰í•˜ê³  í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”:

bash

```bash
python manage.py runserver
```

`http://127.0.0.1:8000`ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”!